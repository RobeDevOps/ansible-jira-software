---
- name: Install package rpm postgresql
  yum:
    name: http://download.postgresql.org/pub/repos/yum/{{postgres_version}}/{{postgres_platform}}/{{platform_arch}}/{{rpm_package}}
    state: present

- name: Install package[{{postgres_package}}]
  yum:
    name: "{{postgres_package}}"
    state: present
    update_cache: yes
  register: package_install

- name: Check if initdb is not empty
  shell: >
    ls /var/lib/pgsql/9.6/data/
  register: db_dir

- name: See data dir
  debug: msg="db_dir"

- name: Init postgresql
  shell: >
    /usr/pgsql-9.6/bin/initdb 
  when: 
    - db_dir is defined 
    - db_dir.stdout != ""
  ignore_errors: "{{ ansible_check_mode }}"